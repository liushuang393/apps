# æ–°ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çµ±åˆã‚¬ã‚¤ãƒ‰

**ä½œæˆæ—¥**: 2025-10-26  
**å¯¾è±¡**: VoiceTranslate Pro æ—¢å­˜ã‚³ãƒ¼ãƒ‰  
**ç›®çš„**: æ–°å®Ÿè£…ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®çµ±åˆæ‰‹é †

---

## ğŸ“‹ çµ±åˆæ¦‚è¦

### çµ±åˆå¯¾è±¡ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

1. **AdaptiveVADBuffer** - é©å¿œçš„VADãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç®¡ç†
2. **AudioValidator** - éŸ³å£°ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
3. **ConversationContext** - ä¼šè©±å±¥æ­´ç®¡ç†
4. **TerminologyManager** - è¡“èªè¾æ›¸ç®¡ç†
5. **StreamingAudioSender** - ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°éŸ³å£°é€ä¿¡
6. **NoiseSuppression** - ãƒã‚¤ã‚ºæŠ‘åˆ¶
7. **ResponseQueue (æ”¹ä¿®ç‰ˆ)** - ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒ»ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½

---

## ğŸ”§ Step 1: TypeScriptãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ“ãƒ«ãƒ‰

### 1.1 ãƒ“ãƒ«ãƒ‰ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ

```bash
# TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
npm run build:core

# ç¢ºèª
ls dist/audio/
ls dist/context/
ls dist/core/
```

### 1.2 æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›

```
dist/
  audio/
    AdaptiveVADBuffer.js
    AudioValidator.js
    StreamingAudioSender.js
    NoiseSuppression.js
  context/
    ConversationContext.js
    TerminologyManager.js
  core/
    ResponseQueue.js (æ›´æ–°)
```

---

## ğŸ”„ Step 2: ResponseQueueçµ±åˆ

### 2.1 æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®ç¢ºèª

ç¾åœ¨ã® `voicetranslate-pro.js`:

```javascript
// è¡Œ88-100: æ—¢å­˜ã®ResponseQueueåˆæœŸåŒ–
this.responseQueue = new ResponseQueue((message) => this.sendMessage(message), {
    maxQueueSize: 10,
    timeout: 60000,
    retryOnError: true,
    maxRetries: 2,
    debugMode: CONFIG.DEBUG_MODE,
    onRequestSending: () => {
        this.pendingResponseId = 'pending_' + Date.now();
    }
});
```

### 2.2 çµ±åˆæ–¹æ³•

**Option A: æ®µéšçš„ç§»è¡Œï¼ˆæ¨å¥¨ï¼‰**

```javascript
// voicetranslate-pro.js ã®å…ˆé ­ã«è¿½åŠ 
import { ResponseQueue } from './dist/core/ResponseQueue.js';

// åˆæœŸåŒ–ã‚³ãƒ¼ãƒ‰ã‚’æ›´æ–°
this.responseQueue = new ResponseQueue((message) => this.sendMessage(message), {
    maxQueueSize: 10,
    timeout: 30000,      // 30ç§’ã«çŸ­ç¸®ï¼ˆã‚ˆã‚Šå³æ ¼ï¼‰
    maxRetries: 2,       // æœ€å¤§2å›ãƒªãƒˆãƒ©ã‚¤
    retryBaseDelay: 1000, // 1ç§’åŸºæœ¬é…å»¶
    debugMode: CONFIG.DEBUG_MODE
});
```

**å¤‰æ›´ç‚¹**:
- âœ… `timeout`: 60ç§’ â†’ 30ç§’ï¼ˆã‚ˆã‚Šå³æ ¼ãªã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼‰
- âœ… `retryBaseDelay`: æ–°è¦è¿½åŠ ï¼ˆã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰
- âŒ `retryOnError`: å‰Šé™¤ï¼ˆå¸¸ã«ãƒªãƒˆãƒ©ã‚¤åˆ¤å®šï¼‰
- âŒ `onRequestSending`: å‰Šé™¤ï¼ˆå†…éƒ¨ã§è‡ªå‹•ç®¡ç†ï¼‰

---

## ğŸ¯ Step 3: AdaptiveVADBufferçµ±åˆ

### 3.1 ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¿½åŠ 

```javascript
// voicetranslate-pro.js ã®å…ˆé ­
import { AdaptiveVADBuffer } from './dist/audio/AdaptiveVADBuffer.js';
```

### 3.2 åˆæœŸåŒ–

```javascript
constructor() {
    // ... æ—¢å­˜ã®åˆæœŸåŒ– ...
    
    // AdaptiveVADBufferè¿½åŠ 
    this.adaptiveVAD = new AdaptiveVADBuffer('ja', 'conversation');
    
    // åˆæœŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—
    const vadParams = this.adaptiveVAD.calculateOptimalParams();
    this.minSpeechDuration = vadParams.minDuration;
    this.silenceConfirmDelay = vadParams.silenceDelay;
    
    console.info('[AdaptiveVAD] Initialized:', vadParams);
}
```

### 3.3 è¨€èªå¤‰æ›´æ™‚ã®æ›´æ–°

```javascript
// æ—¢å­˜ã®è¨€èªå¤‰æ›´å‡¦ç†ã«è¿½åŠ 
async updateSourceLanguage(lang) {
    this.state.sourceLang = lang;
    
    // âœ… AdaptiveVADã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°
    if (this.adaptiveVAD) {
        this.adaptiveVAD.setLanguage(lang);
        const vadParams = this.adaptiveVAD.calculateOptimalParams();
        this.minSpeechDuration = vadParams.minDuration;
        this.silenceConfirmDelay = vadParams.silenceDelay;
        
        console.info('[AdaptiveVAD] Language updated:', vadParams);
    }
}
```

### 3.4 ç™ºè©±å®Œäº†æ™‚ã®å±¥æ­´è¨˜éŒ²

```javascript
// handleAudioBufferCommitted() å†…ã«è¿½åŠ 
handleAudioBufferCommitted() {
    // ... æ—¢å­˜ã®å‡¦ç† ...
    
    // âœ… ç™ºè©±æ™‚é•·ã‚’è¨˜éŒ²ï¼ˆé©å¿œçš„èª¿æ•´ç”¨ï¼‰
    if (this.speechStartTime && this.adaptiveVAD) {
        const duration = Date.now() - this.speechStartTime;
        const silenceBefore = this.silenceConfirmDelay;
        this.adaptiveVAD.recordSpeech(duration, silenceBefore);
        
        if (CONFIG.DEBUG_MODE) {
            console.info('[AdaptiveVAD] Speech recorded:', { duration, silenceBefore });
        }
    }
}
```

---

## ğŸ“Š Step 4: AudioValidatorçµ±åˆ

### 4.1 ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```javascript
import { AudioValidator } from './dist/audio/AudioValidator.js';
```

### 4.2 åˆæœŸåŒ–

```javascript
constructor() {
    // ... æ—¢å­˜ã®åˆæœŸåŒ– ...
    
    // AudioValidatorè¿½åŠ 
    this.audioValidator = new AudioValidator({
        minSampleCount: 4800,    // 200ms @ 24kHz
        minRMSEnergy: 0.001,     // éå¸¸ã«å°ã•ã„é–¾å€¤
        maxZeroRatio: 0.95,      // 95%ä»¥ä¸ŠãŒã‚¼ãƒ­ã®å ´åˆã¯ç„¡åŠ¹
        includeDetails: CONFIG.DEBUG_MODE
    });
}
```

### 4.3 éŸ³å£°ãƒ‡ãƒ¼ã‚¿é€ä¿¡å‰ã®æ¤œè¨¼

```javascript
// handleAudioBufferCommitted() å†…ã®é€ä¿¡å‰ã«æ¤œè¨¼
handleAudioBufferCommitted() {
    // ... æ—¢å­˜ã®å‡¦ç† ...
    
    // âœ… éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œè¨¼
    const audioData = this.getAccumulatedAudioData(); // Float32Array
    const validation = this.audioValidator.validate(audioData);
    
    if (!validation.valid) {
        console.warn('[AudioValidator] Invalid audio data:', validation.reason);
        this.resetAudioBuffer(); // ãƒãƒƒãƒ•ã‚¡ã‚’ã‚¯ãƒªã‚¢
        return; // é€ä¿¡ã—ãªã„
    }
    
    if (CONFIG.DEBUG_MODE && validation.details) {
        console.info('[AudioValidator] Audio quality:', validation.details);
    }
    
    // ... Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã¨é€ä¿¡ ...
}
```

---

## ğŸ’¬ Step 5: ConversationContextçµ±åˆ

### 5.1 ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```javascript
import { ConversationContext } from './dist/context/ConversationContext.js';
```

### 5.2 åˆæœŸåŒ–

```javascript
constructor() {
    // ... æ—¢å­˜ã®åˆæœŸåŒ– ...
    
    // ConversationContextè¿½åŠ 
    this.conversationContext = new ConversationContext(5, 300000); // 5ä»¶ã€5åˆ†
}
```

### 5.3 ä¼šè©±ã‚¨ãƒ³ãƒˆãƒªè¿½åŠ 

```javascript
// handleResponseAudioTranscriptDelta() å†…ã«è¿½åŠ 
handleResponseAudioTranscriptDelta(delta) {
    // ... æ—¢å­˜ã®å‡¦ç† ...
    
    // âœ… ä¼šè©±å±¥æ­´ã«è¿½åŠ ï¼ˆç¿»è¨³å®Œäº†æ™‚ï¼‰
    if (this.conversationContext && this.currentTranslationText) {
        this.conversationContext.addEntry(
            this.currentSourceText || '',        // åŸæ–‡
            this.currentTranslationText,         // è¨³æ–‡
            this.state.targetLang || 'en',      // è¨€èª
            0.9                                  // ä¿¡é ¼åº¦ï¼ˆä»®ï¼‰
        );
    }
}
```

### 5.4 WebSocketæ¥ç¶šæ™‚ã«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’é€ä¿¡

```javascript
// createSession() å†…ã§ Instructions ã«è¿½åŠ 
async createSession() {
    // ... æ—¢å­˜ã®å‡¦ç† ...
    
    // âœ… ä¼šè©±ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
    let contextString = '';
    if (this.conversationContext) {
        const context = this.conversationContext.getContext();
        if (context.historyCount > 0) {
            contextString = '\n\nã€ä¼šè©±å±¥æ­´ã€‘\n' + context.contextString;
        }
    }
    
    const sessionConfig = {
        type: 'session.update',
        session: {
            // ... æ—¢å­˜ã®è¨­å®š ...
            instructions: this.buildInstructions() + contextString
        }
    };
    
    // ... é€ä¿¡ ...
}
```

---

## ğŸ“š Step 6: TerminologyManagerçµ±åˆ

### 6.1 ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```javascript
import { TerminologyManager } from './dist/context/TerminologyManager.js';
```

### 6.2 åˆæœŸåŒ–

```javascript
constructor() {
    // ... æ—¢å­˜ã®åˆæœŸåŒ– ...
    
    // TerminologyManagerè¿½åŠ 
    this.terminologyManager = new TerminologyManager();
    
    // LocalStorageã‹ã‚‰èª­ã¿è¾¼ã¿
    this.terminologyManager.loadFromLocalStorage();
}
```

### 6.3 Instructionsç”Ÿæˆã«çµ±åˆ

```javascript
buildInstructions() {
    // æ—¢å­˜ã®Instructionsç”Ÿæˆã‚’ç½®ãæ›ãˆ
    if (this.terminologyManager) {
        return this.terminologyManager.generateInstructions({
            sourceLang: this.state.sourceLang || 'auto',
            targetLang: this.state.targetLang || 'en',
            style: 'formal' // ã¾ãŸã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š
        });
    }
    
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆæ—¢å­˜ã®å®Ÿè£…ï¼‰
    return `ã‚ãªãŸã¯${this.state.sourceLang}ã‹ã‚‰${this.state.targetLang}ã¸ã®åŒæ™‚é€šè¨³è€…ã§ã™ã€‚`;
}
```

### 6.4 UIè¿½åŠ ï¼ˆè¡“èªè¾æ›¸ç®¡ç†ï¼‰

```html
<!-- teams-realtime-translator.html ã«è¿½åŠ  -->
<div class="terminology-section">
    <h3>è¡“èªè¾æ›¸</h3>
    <div class="terminology-controls">
        <input type="text" id="termSource" placeholder="åŸèª">
        <input type="text" id="termTarget" placeholder="è¨³èª">
        <select id="termDomain">
            <option value="IT">IT</option>
            <option value="medical">åŒ»ç™‚</option>
            <option value="business">ãƒ“ã‚¸ãƒã‚¹</option>
        </select>
        <input type="number" id="termPriority" min="1" max="10" value="5" placeholder="å„ªå…ˆåº¦">
        <button id="addTermBtn">è¿½åŠ </button>
    </div>
    <div id="termList"></div>
</div>
```

```javascript
// UI ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
document.getElementById('addTermBtn').addEventListener('click', () => {
    const source = document.getElementById('termSource').value;
    const target = document.getElementById('termTarget').value;
    const domain = document.getElementById('termDomain').value;
    const priority = parseInt(document.getElementById('termPriority').value);
    
    if (source && target) {
        this.terminologyManager.addUserTerm({
            source,
            target,
            domain,
            priority,
            createdAt: Date.now()
        });
        
        // LocalStorageã«ä¿å­˜
        this.terminologyManager.saveToLocalStorage();
        
        // UIæ›´æ–°
        this.updateTermList();
        
        // å…¥åŠ›ã‚¯ãƒªã‚¢
        document.getElementById('termSource').value = '';
        document.getElementById('termTarget').value = '';
    }
});
```

---

## ğŸŒŠ Step 7: StreamingAudioSenderçµ±åˆ

### 7.1 ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```javascript
import { StreamingAudioSender } from './dist/audio/StreamingAudioSender.js';
```

### 7.2 åˆæœŸåŒ–

```javascript
constructor() {
    // ... æ—¢å­˜ã®åˆæœŸåŒ– ...
    
    // StreamingAudioSenderè¿½åŠ 
    this.streamingSender = new StreamingAudioSender(
        (base64Audio) => this.sendAudioChunk(base64Audio),
        {
            chunkSize: 2400,    // 100ms @ 24kHz
            sendInterval: 100,   // 100ms
            maxBufferSize: 48000 // 2ç§’
        }
    );
}

// éŸ³å£°ãƒãƒ£ãƒ³ã‚¯é€ä¿¡é–¢æ•°
sendAudioChunk(base64Audio) {
    if (this.state.ws && this.state.ws.readyState === WebSocket.OPEN) {
        this.state.ws.send(JSON.stringify({
            type: 'input_audio_buffer.append',
            audio: base64Audio
        }));
    }
}
```

### 7.3 ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é€ä¿¡é–‹å§‹ãƒ»åœæ­¢

```javascript
// ç™ºè©±é–‹å§‹æ™‚
handleSpeechStarted() {
    // ... æ—¢å­˜ã®å‡¦ç† ...
    
    // âœ… ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é€ä¿¡é–‹å§‹
    if (this.streamingSender) {
        this.streamingSender.start();
    }
}

// ç™ºè©±çµ‚äº†æ™‚
handleSpeechEnded() {
    // ... æ—¢å­˜ã®å‡¦ç† ...
    
    // âœ… ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é€ä¿¡åœæ­¢ï¼‹ãƒ•ãƒ©ãƒƒã‚·ãƒ¥
    if (this.streamingSender) {
        this.streamingSender.flush(); // æ®‹ã‚Šã‚’é€ä¿¡
        this.streamingSender.stop();
    }
}
```

### 7.4 éŸ³å£°ãƒ‡ãƒ¼ã‚¿è¿½åŠ 

```javascript
// éŸ³å£°å‡¦ç†ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å†…
processAudioData(audioData) {
    // ... æ—¢å­˜ã®å‡¦ç† ...
    
    // âœ… ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒãƒƒãƒ•ã‚¡ã«è¿½åŠ 
    if (this.streamingSender && this.streamingSender.isActive) {
        this.streamingSender.append(audioData); // Float32Array
        // è‡ªå‹•çš„ã«100msã”ã¨ã«é€ä¿¡ã•ã‚Œã‚‹
    }
}
```

---

## ğŸ”‡ Step 8: NoiseSuppressionçµ±åˆ

### 8.1 ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```javascript
import { NoiseSuppression } from './dist/audio/NoiseSuppression.js';
```

### 8.2 åˆæœŸåŒ–

```javascript
constructor() {
    // ... æ—¢å­˜ã®åˆæœŸåŒ– ...
    
    // NoiseSuppressionè¿½åŠ 
    this.noiseSuppression = new NoiseSuppression({
        highpassFreq: 100,   // 100Hz
        lowpassFreq: 8000,   // 8kHz
        gain: 1.0,
        enabled: true
    });
}
```

### 8.3 éŸ³å£°ã‚­ãƒ£ãƒ—ãƒãƒ£æ™‚ã«é©ç”¨

```javascript
async startMicrophoneCapture() {
    // ... MediaStreamå–å¾— ...
    const stream = await navigator.mediaDevices.getUserMedia({
        audio: {
            echoCancellation: true,
            noiseSuppression: true, // ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒã‚¤ã‚ºæŠ‘åˆ¶ã‚‚ä½µç”¨
            autoGainControl: true
        }
    });
    
    // âœ… ãƒã‚¤ã‚ºã‚µãƒ—ãƒ¬ãƒƒã‚·ãƒ§ãƒ³é©ç”¨
    if (this.noiseSuppression) {
        const processedStream = this.noiseSuppression.apply(
            stream,
            this.state.audioContext
        );
        
        // processedStream.stream ã‚’ä½¿ç”¨
        this.state.audioSource = this.state.audioContext.createMediaStreamSource(
            processedStream.stream
        );
    }
    
    // ... æ—¢å­˜ã®éŸ³å£°å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ¥ç¶š ...
}
```

---

## ğŸ›ï¸ Step 9: UIè¨­å®šè¿½åŠ 

### 9.1 è¨­å®šãƒ‘ãƒãƒ«æ‹¡å¼µ

```html
<!-- teams-realtime-translator.html ã«è¿½åŠ  -->
<div class="advanced-settings">
    <h3>é«˜åº¦ãªè¨­å®š</h3>
    
    <!-- ã‚·ãƒŠãƒªã‚ªé¸æŠ -->
    <div class="setting-item">
        <label for="scenarioSelect">ã‚·ãƒŠãƒªã‚ª:</label>
        <select id="scenarioSelect">
            <option value="meeting">ä¼šè­°ï¼ˆç²¾åº¦å„ªå…ˆï¼‰</option>
            <option value="conversation" selected>æ—¥å¸¸ä¼šè©±ï¼ˆãƒãƒ©ãƒ³ã‚¹ï¼‰</option>
            <option value="quickChat">çŸ­å¯¾è©±ï¼ˆé€Ÿåº¦å„ªå…ˆï¼‰</option>
        </select>
    </div>
    
    <!-- ãƒã‚¤ã‚ºæŠ‘åˆ¶ON/OFF -->
    <div class="setting-item">
        <label>
            <input type="checkbox" id="noiseSuppressionCheck" checked>
            ãƒã‚¤ã‚ºæŠ‘åˆ¶
        </label>
    </div>
    
    <!-- ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é€ä¿¡ON/OFF -->
    <div class="setting-item">
        <label>
            <input type="checkbox" id="streamingCheck" checked>
            ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°é€ä¿¡ï¼ˆä½é…å»¶ï¼‰
        </label>
    </div>
</div>
```

### 9.2 ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©

```javascript
// ã‚·ãƒŠãƒªã‚ªå¤‰æ›´
document.getElementById('scenarioSelect').addEventListener('change', (e) => {
    if (this.adaptiveVAD) {
        this.adaptiveVAD.setScenario(e.target.value);
        const params = this.adaptiveVAD.calculateOptimalParams();
        this.minSpeechDuration = params.minDuration;
        this.silenceConfirmDelay = params.silenceDelay;
        console.info('[UI] Scenario changed:', params);
    }
});

// ãƒã‚¤ã‚ºæŠ‘åˆ¶ON/OFF
document.getElementById('noiseSuppressionCheck').addEventListener('change', (e) => {
    if (this.noiseSuppression) {
        this.noiseSuppression.updateConfig({ enabled: e.target.checked });
        console.info('[UI] Noise suppression:', e.target.checked);
    }
});
```

---

## âœ… Step 10: çµ±åˆãƒ†ã‚¹ãƒˆ

### 10.1 ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª

1. **åŸºæœ¬å‹•ä½œãƒ†ã‚¹ãƒˆ**
   - [ ] ãƒã‚¤ã‚¯éŸ³å£°èªè­˜
   - [ ] ç¿»è¨³å®Ÿè¡Œ
   - [ ] éŸ³å£°å†ç”Ÿ

2. **AdaptiveVAD ãƒ†ã‚¹ãƒˆ**
   - [ ] è¨€èªå¤‰æ›´æ™‚ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°
   - [ ] ã‚·ãƒŠãƒªã‚ªå¤‰æ›´æ™‚ã®å‹•ä½œç¢ºèª
   - [ ] å±¥æ­´è¨˜éŒ²ã¨é©å¿œèª¿æ•´

3. **AudioValidator ãƒ†ã‚¹ãƒˆ**
   - [ ] ç„¡éŸ³ãƒ‡ãƒ¼ã‚¿ã®æ‹’å¦
   - [ ] çŸ­ã™ãã‚‹ãƒ‡ãƒ¼ã‚¿ã®æ‹’å¦
   - [ ] æœ‰åŠ¹ãƒ‡ãƒ¼ã‚¿ã®é€šé

4. **ResponseQueue ãƒ†ã‚¹ãƒˆ**
   - [ ] ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå‹•ä½œ
   - [ ] ãƒªãƒˆãƒ©ã‚¤å‹•ä½œ
   - [ ] ã‚¨ã‚¯ã‚¹ãƒãƒãƒ³ã‚·ãƒ£ãƒ«ãƒãƒƒã‚¯ã‚ªãƒ•

5. **ConversationContext ãƒ†ã‚¹ãƒˆ**
   - [ ] ä¼šè©±å±¥æ­´ä¿å­˜
   - [ ] ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
   - [ ] 5ä»¶åˆ¶é™

6. **TerminologyManager ãƒ†ã‚¹ãƒˆ**
   - [ ] è¡“èªè¿½åŠ ãƒ»å‰Šé™¤
   - [ ] LocalStorageæ°¸ç¶šåŒ–
   - [ ] Instructionsç”Ÿæˆ

7. **StreamingAudioSender ãƒ†ã‚¹ãƒˆ**
   - [ ] ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²é€ä¿¡
   - [ ] 100msé–“éš”ç¢ºèª
   - [ ] flushå‹•ä½œ

8. **NoiseSuppression ãƒ†ã‚¹ãƒˆ**
   - [ ] ãƒã‚¤ã‚ºé™¤å»åŠ¹æœ
   - [ ] ON/OFFåˆ‡ã‚Šæ›¿ãˆ
   - [ ] ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰æ›´

---

## ğŸ“ çµ±åˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ã‚³ãƒ¼ãƒ‰å¤‰æ›´
- [ ] TypeScriptãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ (`npm run build:core`)
- [ ] ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–‡è¿½åŠ ï¼ˆ8ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰
- [ ] åˆæœŸåŒ–ã‚³ãƒ¼ãƒ‰è¿½åŠ 
- [ ] æ—¢å­˜å‡¦ç†ã¸ã®çµ±åˆ

### ãƒ†ã‚¹ãƒˆ
- [ ] ESLint ãƒã‚§ãƒƒã‚¯ (`npm run lint`)
- [ ] TypeScriptå‹ãƒã‚§ãƒƒã‚¯ (`npm run type-check`)
- [ ] ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ (`npm test`)
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [ ] CHANGELOGæ›´æ–°
- [ ] READMEæ›´æ–°
- [ ] API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ

### ãƒ‡ãƒ—ãƒ­ã‚¤
- [ ] ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬
- [ ] ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ ãƒ‡ãƒ—ãƒ­ã‚¤

---

## ğŸš¨ æ³¨æ„äº‹é …

### 1. äº’æ›æ€§

æ—¢å­˜ã®æ©Ÿèƒ½ã‚’å£Šã•ãªã„ã‚ˆã†ã€æ®µéšçš„ã«çµ±åˆã—ã¦ãã ã•ã„ï¼š

```javascript
// âŒ æ‚ªã„ä¾‹: ä¸€åº¦ã«ã™ã¹ã¦ç½®ãæ›ãˆ
constructor() {
    // æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’å…¨å‰Šé™¤ã—ã¦æ–°ã‚³ãƒ¼ãƒ‰ã«ç½®ãæ›ãˆ
}

// âœ… è‰¯ã„ä¾‹: æ®µéšçš„ã«è¿½åŠ 
constructor() {
    // æ—¢å­˜ã®åˆæœŸåŒ–ã‚’ä¿æŒ
    this.initExistingFeatures();
    
    // æ–°æ©Ÿèƒ½ã‚’è¿½åŠ 
    if (CONFIG.ENABLE_ADAPTIVE_VAD) {
        this.adaptiveVAD = new AdaptiveVADBuffer('ja', 'conversation');
    }
}
```

### 2. ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ•ãƒ©ã‚°

æ–°æ©Ÿèƒ½ã¯åˆæœŸçŠ¶æ…‹ã§ç„¡åŠ¹åŒ–å¯èƒ½ã«ã—ã¦ãã ã•ã„ï¼š

```javascript
// config ã«è¿½åŠ 
const CONFIG = {
    // ... æ—¢å­˜ã®è¨­å®š ...
    
    // æ–°æ©Ÿèƒ½ãƒ•ãƒ©ã‚°
    ENABLE_ADAPTIVE_VAD: true,
    ENABLE_AUDIO_VALIDATOR: true,
    ENABLE_CONVERSATION_CONTEXT: true,
    ENABLE_TERMINOLOGY: true,
    ENABLE_STREAMING_SENDER: false, // åˆæœŸã¯ç„¡åŠ¹
    ENABLE_NOISE_SUPPRESSION: true
};
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

ã™ã¹ã¦ã®æ–°æ©Ÿèƒ½ã«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’è¿½åŠ ï¼š

```javascript
try {
    if (this.adaptiveVAD) {
        const params = this.adaptiveVAD.calculateOptimalParams();
        // ...
    }
} catch (error) {
    console.error('[AdaptiveVAD] Error:', error);
    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: æ—¢å­˜ã®å›ºå®šå€¤ã‚’ä½¿ç”¨
    this.minSpeechDuration = 1000;
    this.silenceConfirmDelay = 500;
}
```

---

## ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹æ”¹å–„åŠ¹æœ

çµ±åˆå®Œäº†å¾Œã€ä»¥ä¸‹ã®æ”¹å–„ãŒæœŸå¾…ã•ã‚Œã¾ã™ï¼š

| æŒ‡æ¨™ | æ”¹å–„å‰ | æ”¹å–„å¾Œ | æ¸¬å®šæ–¹æ³• |
|-----|-------|-------|---------|
| æ–‡æ¼ã‚Œç‡ | 5-8% | < 2% | 100ç™ºè©±ãƒ†ã‚¹ãƒˆ |
| E2Eé…å»¶ (p50) | 1.8s | < 1.2s | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ |
| è¡“èªä¸€è²«æ€§ | 60% | > 85% | è¡“èªå‡ºç¾ç‡ |
| ãƒã‚¤ã‚ºè€æ€§ | SNR 10dB: CER +15% | < +5% | ãƒã‚¤ã‚ºç’°å¢ƒãƒ†ã‚¹ãƒˆ |

---

**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: Step 1ã‹ã‚‰é †ç•ªã«å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚


